/*
....................................................................................................
....                                                                                               .
....                                                                                               .
....                                         .                                                     .
....                                   .........................                                   .
....                           .....   ......::=***===+=-:......                                   .
....                        .............=######%#####=-:...........                               .
....                        ....:=-...:*+==+#######*#####--=++*-....                               .
....                    ......-*####++-..:+###%*=--:.####*--*####+:...........                     .
....                    ..:+*##########*-.-=:..::....*###*:..:*####*+*:.......                     .
....               ......-**####*-*#####*=...........*###*:.*#####*####*+-......                   .
....               .....*#####*:....-####=... ....:+####*:.+###:...+#*-*##+.....                   .
....             ....:###*##%*..   ...####=.....:######*:..:###...:*##:.+##%%-....                 .
....             ...::-:-==#*-..   ..=%##*-..:*####%*#:.....+#%#%%%%#*...:+###+:..                 .
....          .......=-...=*-...   ..-####==######*=..........+##**+......:+####-....              .
....          ...-..............   ..-%#%##%###==:..:-+*#%%%%%%###+-:.. ...:*####+:..              .
....          ..-*.:-.=#+*#+++:......*#######*-..:*##################%*=:.....+###=....            .
....          ..#-=##*#%#########=..:#######-....:=###################%###+:..:+##*+...            .
....      .....+#######+-+++#####%#=:#####%=..   ..:########################*:.:+##*.....          .
....      ....+#####*-......:-*###%#####%#=...   ...+######*##%#=..:*#########*:.-*#%:...          .
....      ...==%###*-..     ....+##########=........+##%##-....::....-%##*##%###=.=##=+..          .
....      ...-#####=..  .   .....:##########+:.....+#%#%##*-.....+##+..=...+#%%##=:####..          .
....      ...=##*#*=:........:-:..+##########%####%###%#-......:+%##%##:....*####%+-###-.          .
....      ..:##.++#+:.....:*#%##-.-*################%#######*-=%########+...:%####%=:##=.          .
....      ...==:+:++-...-*#%####*..:*####################################*:..*######:-#+.          .
....      ...=++.........:+######:..:+####################################*:.=%%####*.++.          .
....      ...-*%:...........:+%##+....+####################################+....-*##%::+.          .
....      ...-##:.:--*#-=+:...-%##=....:*%################################%#=....=##%-.:.          .
....      ....*%=:*#%%%####+:.:%###+:.....-#%################################....=###=...          .
....      ...:*%#=#=.....+##*-*#*:*%#+....:*%#######%###############%#*######=...+###=...          .
....      .....###*:.....:+#*-#+...-####*::*###%#*+##################*.:#####*..-###%-...          .
....         ..*%#=.......+#*=.......:*#########+.+#################=+.:*#####..+###%....          .
....          ..=%#+:...:+##-...   ......=*####*..+##################=.:######...+##*....          .
....          ..+####%##%*-=......:--.......+#+...-*#######*=#######::.=%####*...-##:...           .
....          ...=#*-..+-....  ..-=*#*.....::......-*#####=.:#######*...-*###=...=#=...            .
....          ...-*#*:....... ..:=#####=............=#####-.=######++...-####...-#+..              .
....          ....:=##=...    ..+######%#*=:....:=+*######=.+######=...=##%%=..-*+...              .
....          . ...:+##*:.......:::.::*%#####%%%%#####%##*:-#######-.:####%+..-#=....              .
....             ....:=##=.............-#*:.............::.+#####=::######+..*#:....               .
....               ...:####=........ ..-##=...   ........+######+...:%###=.-#-...                  .
....               ......-*###=:.......:+:............:=#%###%-.....:%#*::+:......                 .
....                    ...-+*###*-:..............:-=######=+:...:-+##-.:.....                     .
....                    .....-+#######*++====+*######%**#+:..+**###*-........                      .
....                        .....:*###%######%###*+#*=.....:*###*=:....                            .
....                        ...........:===:.-+=-......:=+###+-:.....                              .
....                           .............:-+***####*+=-:.........                               .
....                                      ......................                                   .
....                                                 ....                                          .
....                                                                                               .
....                                                                                               .
....                                                                                               .
....................................................................................................
                     WhEN In DoUBt,  (╯°□°）╯︵ ┻━┻ ....ReComPiLe.
*/
// g++ -std=c++17 new.cpp -o new
// ./new
//g++ -std=c++17 -Wall -Wextra -O2 s.cpp -o file-name 
//./file-name
#undef _GLIBCXX_DEBUG
#include <bits/stdc++.h>
using namespace std;

#ifdef LOCAL
#include "algo/debug.h"
#else
#define debug(...) 42
#endif

using vi = vector<int>;
#define ll long long
#define pb push_back
#define FOR(i,a,b) for(int i=(a); i<(b); ++i)
#define RFOR(i,a,b) for(int i=(a); i>=(b); --i)
#define all(x) (x).begin(),(x).end()
#define sz(x) int((x).size())
#define F first
#define S second
#define mkp make_pair
#define mT empty
#define CLR(x,v) memset(x,v,sizeof(x))
#define CLAMP(x,l,u) ((x)<(l)?(l):((x)>(u)?(u):(x)))
#define PQ(name) priority_queue<int, vector<int>, greater<int>> name

void solve(){
   //soLuSHoNN hErE.........
    int n; 
    if(!(cin>>n)) return ;
    vi A(n), B(n);
    FOR(i,0,n) cin>>A[i];
    FOR(i,0,n) cin>>B[i];

    vi pre(n), suf(n);
    pre[0]=A[0];
    FOR(i,1,n){ pre[i]=min(pre[i-1], A[i]); A[i]=max(A[i-1], A[i]); }
    suf[n-1]=B[n-1];
    RFOR(i,n-2,0){ suf[i]=min(suf[i+1], B[i]); B[i]=max(B[i+1], B[i]); }

    int L = 2*n;
    vector<vi> bk(L+2);
    FOR(i,0,n){
        int m = CLAMP(min(pre[i], suf[i]), 1, L);
        bk[m].pb(max(A[i], B[i]));
    }

    ll res = 0;
    PQ(pq);
    RFOR(i,L,1){
        for(int v: bk[i]) pq.push(v);
        if(!pq.mT()){
            int r = max(pq.top(), i);
            if(r <= L) res += (ll)(L - r + 1);
        }
    }
    cout << res << '\n';
}

int main(){
    /* 
    freopen("in.txt", "r", stdin);
    freopen("out.txt", "w", stdout); 
    */
    ios_base::sync_with_stdio(0);
    cin.tie(0); cout.tie(0);
    int t(1), tcase(0); cin>>t;
    while (++tcase, t--) solve();
}